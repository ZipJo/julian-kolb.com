!function(a){var b={set:{colors:1,values:1,backgroundColor:1,scaleColors:1,normalizeFunction:1,focus:1},get:{selectedRegions:1,selectedMarkers:1,mapObject:1,regionName:1}};a.fn.vectorMap=function(a){var c;var e=this.children(".jvectormap-container").data("mapObject");if("addMap"===a)jvm.Map.maps[arguments[1]]=arguments[2];else{if(("set"===a||"get"===a)&&b[a][arguments[1]])return c=arguments[1].charAt(0).toUpperCase()+arguments[1].substr(1),e[a+c].apply(e,Array.prototype.slice.call(arguments,2));a=
a||{};a.container=this;new jvm.Map(a)}return this}}(jQuery);
(function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)})(function(a){function b(b){var g=b||window.event,k=f.call(arguments,1),n,h=0,l=0,m=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(l=-1*g.detail),"wheelDelta"in g&&(l=g.wheelDelta),"wheelDeltaY"in g&&(l=g.wheelDeltaY),"wheelDeltaX"in g&&(h=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(h=-1*l,l=0),n=0===l?h:l,"deltaY"in g&&(l=-1*g.deltaY,n=l),"deltaX"in
g&&(h=g.deltaX,0===l&&(n=-1*h)),0!==l||0!==h){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");n*=q;l*=q;h*=q}else 2===g.deltaMode&&(q=a.data(this,"mousewheel-page-height"),n*=q,l*=q,h*=q);return m=Math.max(Math.abs(l),Math.abs(h)),(!e||e>m)&&(e=m,p.settings.adjustOldDeltas&&"mousewheel"===g.type&&0===m%120&&(e/=40)),p.settings.adjustOldDeltas&&"mousewheel"===g.type&&0===m%120&&(n/=40,h/=40,l/=40),n=Math[1<=n?"floor":"ceil"](n/e),h=Math[1<=h?"floor":"ceil"](h/e),l=Math[1<=l?"floor":
"ceil"](l/e),b.deltaX=h,b.deltaY=l,b.deltaFactor=e,b.deltaMode=0,k.unshift(b,n,h,l),d&&clearTimeout(d),d=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,k)}}function c(){e=null}var d,e,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],k="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],f=Array.prototype.slice;if(a.event.fixHooks)for(var m=g.length;m;)a.event.fixHooks[g[--m]]=a.event.mouseHooks;var p=a.event.special.mousewheel=
{version:"3.1.9",setup:function(){if(this.addEventListener)for(var c=k.length;c;)this.addEventListener(k[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",p.getLineHeight(this));a.data(this,"mousewheel-page-height",p.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var a=k.length;a;)this.removeEventListener(k[--a],b,!1);else this.onmousewheel=null},getLineHeight:function(b){return parseInt(a(b)["offsetParent"in a.fn?"offsetParent":"parent"]().css("fontSize"),
10)},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});
var jvm={inherits:function(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.parentClass=b},mixin:function(a,b){for(var c in b.prototype)b.prototype.hasOwnProperty(c)&&(a.prototype[c]=b.prototype[c])},min:function(a){var b,c=Number.MAX_VALUE;if(a instanceof Array)for(b=0;b<a.length;b++)a[b]<c&&(c=a[b]);else for(b in a)a[b]<c&&(c=a[b]);return c},max:function(a){var b,c=Number.MIN_VALUE;if(a instanceof Array)for(b=0;b<a.length;b++)a[b]>c&&(c=a[b]);else for(b in a)a[b]>
c&&(c=a[b]);return c},keys:function(a){var b,c=[];for(b in a)c.push(b);return c},values:function(a){var b,c,d=[];for(c=0;c<arguments.length;c++)for(b in a=arguments[c],a)d.push(a[b]);return d},whenImageLoaded:function(a){var b=new jvm.$.Deferred,c=jvm.$("<img/>");return c.error(function(){b.reject()}).load(function(){b.resolve(c)}),c.attr("src",a),b},isImageUrl:function(a){return/\.\w{3,4}$/.test(a)}};jvm.$=jQuery;
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),d=c.length>>>0;if(0===d)return-1;var e=+b||0;if(1/0===Math.abs(e)&&(e=0),e>=d)return-1;for(e=Math.max(0<=e?e:d-Math.abs(e),0);d>e;){if(e in c&&c[e]===a)return e;e++}return-1});jvm.AbstractElement=function(a,b){this.node=this.createElement(a);this.name=a;this.properties={};b&&this.set(b)};
jvm.AbstractElement.prototype.set=function(a,b){var c;if("object"==typeof a)for(c in a)this.properties[c]=a[c],this.applyAttr(c,a[c]);else this.properties[a]=b,this.applyAttr(a,b)};jvm.AbstractElement.prototype.get=function(a){return this.properties[a]};jvm.AbstractElement.prototype.applyAttr=function(a,b){this.node.setAttribute(a,b)};jvm.AbstractElement.prototype.remove=function(){jvm.$(this.node).remove()};
jvm.AbstractCanvasElement=function(a,b,c){this.container=a;this.setSize(b,c);this.rootElement=new jvm[this.classPrefix+"GroupElement"];this.node.appendChild(this.rootElement.node);this.container.appendChild(this.node)};jvm.AbstractCanvasElement.prototype.add=function(a,b){b=b||this.rootElement;b.add(a);a.canvas=this};jvm.AbstractCanvasElement.prototype.addPath=function(a,b,c){a=new jvm[this.classPrefix+"PathElement"](a,b);return this.add(a,c),a};
jvm.AbstractCanvasElement.prototype.addCircle=function(a,b,c){a=new jvm[this.classPrefix+"CircleElement"](a,b);return this.add(a,c),a};jvm.AbstractCanvasElement.prototype.addImage=function(a,b,c){a=new jvm[this.classPrefix+"ImageElement"](a,b);return this.add(a,c),a};jvm.AbstractCanvasElement.prototype.addText=function(a,b,c){a=new jvm[this.classPrefix+"TextElement"](a,b);return this.add(a,c),a};
jvm.AbstractCanvasElement.prototype.addGroup=function(a){var b=new jvm[this.classPrefix+"GroupElement"];return a?a.node.appendChild(b.node):this.node.appendChild(b.node),b.canvas=this,b};jvm.AbstractShapeElement=function(a,b,c){this.style=c||{};this.style.current=this.style.current||{};this.isSelected=this.isHovered=!1;this.updateStyle()};jvm.AbstractShapeElement.prototype.setStyle=function(a,b){var c={};"object"==typeof a?c=a:c[a]=b;jvm.$.extend(this.style.current,c);this.updateStyle()};
jvm.AbstractShapeElement.prototype.updateStyle=function(){var a={};jvm.AbstractShapeElement.mergeStyles(a,this.style.initial);jvm.AbstractShapeElement.mergeStyles(a,this.style.current);this.isHovered&&jvm.AbstractShapeElement.mergeStyles(a,this.style.hover);this.isSelected&&(jvm.AbstractShapeElement.mergeStyles(a,this.style.selected),this.isHovered&&jvm.AbstractShapeElement.mergeStyles(a,this.style.selectedHover));this.set(a)};
jvm.AbstractShapeElement.mergeStyles=function(a,b){var c;b=b||{};for(c in b)null===b[c]?delete a[c]:a[c]=b[c]};jvm.SVGElement=function(){jvm.SVGElement.parentClass.apply(this,arguments)};jvm.inherits(jvm.SVGElement,jvm.AbstractElement);jvm.SVGElement.svgns="http://www.w3.org/2000/svg";jvm.SVGElement.prototype.createElement=function(a){return document.createElementNS(jvm.SVGElement.svgns,a)};jvm.SVGElement.prototype.addClass=function(a){this.node.setAttribute("class",a)};
jvm.SVGElement.prototype.getElementCtr=function(a){return jvm["SVG"+a]};jvm.SVGElement.prototype.getBBox=function(){return this.node.getBBox()};jvm.SVGGroupElement=function(){jvm.SVGGroupElement.parentClass.call(this,"g")};jvm.inherits(jvm.SVGGroupElement,jvm.SVGElement);jvm.SVGGroupElement.prototype.add=function(a){this.node.appendChild(a.node)};
jvm.SVGCanvasElement=function(){this.classPrefix="SVG";jvm.SVGCanvasElement.parentClass.call(this,"svg");this.defsElement=new jvm.SVGElement("defs");this.node.appendChild(this.defsElement.node);jvm.AbstractCanvasElement.apply(this,arguments)};jvm.inherits(jvm.SVGCanvasElement,jvm.SVGElement);jvm.mixin(jvm.SVGCanvasElement,jvm.AbstractCanvasElement);jvm.SVGCanvasElement.prototype.setSize=function(a,b){this.width=a;this.height=b;this.node.setAttribute("width",a);this.node.setAttribute("height",b)};
jvm.SVGCanvasElement.prototype.applyTransformParams=function(a,b,c){this.scale=a;this.transX=b;this.transY=c;this.rootElement.node.setAttribute("transform","scale("+a+") translate("+b+", "+c+")")};jvm.SVGShapeElement=function(a,b){jvm.SVGShapeElement.parentClass.call(this,a,b);jvm.AbstractShapeElement.apply(this,arguments)};jvm.inherits(jvm.SVGShapeElement,jvm.SVGElement);jvm.mixin(jvm.SVGShapeElement,jvm.AbstractShapeElement);
jvm.SVGShapeElement.prototype.applyAttr=function(a,b){var c,d,e=this;"fill"===a&&jvm.isImageUrl(b)?jvm.SVGShapeElement.images[b]?this.applyAttr("fill","url(#image"+jvm.SVGShapeElement.images[b]+")"):jvm.whenImageLoaded(b).then(function(a){d=new jvm.SVGElement("image");d.node.setAttributeNS("http://www.w3.org/1999/xlink","href",b);d.applyAttr("x","0");d.applyAttr("y","0");d.applyAttr("width",a[0].width);d.applyAttr("height",a[0].height);c=new jvm.SVGElement("pattern");c.applyAttr("id","image"+jvm.SVGShapeElement.imageCounter);
c.applyAttr("x",0);c.applyAttr("y",0);c.applyAttr("width",a[0].width/2);c.applyAttr("height",a[0].height/2);c.applyAttr("viewBox","0 0 "+a[0].width+" "+a[0].height);c.applyAttr("patternUnits","userSpaceOnUse");c.node.appendChild(d.node);e.canvas.defsElement.node.appendChild(c.node);jvm.SVGShapeElement.images[b]=jvm.SVGShapeElement.imageCounter++;e.applyAttr("fill","url(#image"+jvm.SVGShapeElement.images[b]+")")}):jvm.SVGShapeElement.parentClass.prototype.applyAttr.apply(this,arguments)};
jvm.SVGShapeElement.imageCounter=1;jvm.SVGShapeElement.images={};jvm.SVGPathElement=function(a,b){jvm.SVGPathElement.parentClass.call(this,"path",a,b);this.node.setAttribute("fill-rule","evenodd")};jvm.inherits(jvm.SVGPathElement,jvm.SVGShapeElement);jvm.SVGCircleElement=function(a,b){jvm.SVGCircleElement.parentClass.call(this,"circle",a,b)};jvm.inherits(jvm.SVGCircleElement,jvm.SVGShapeElement);jvm.SVGImageElement=function(a,b){jvm.SVGImageElement.parentClass.call(this,"image",a,b)};
jvm.inherits(jvm.SVGImageElement,jvm.SVGShapeElement);
jvm.SVGImageElement.prototype.applyAttr=function(a,b){var c=this;"image"==a?jvm.whenImageLoaded(b).then(function(a){c.node.setAttributeNS("http://www.w3.org/1999/xlink","href",b);c.width=a[0].width;c.height=a[0].height;c.applyAttr("width",c.width);c.applyAttr("height",c.height);c.applyAttr("x",c.cx-c.width/2);c.applyAttr("y",c.cy-c.height/2);jvm.$(c.node).trigger("imageloaded",[a])}):"cx"==a?(this.cx=b,this.width&&this.applyAttr("x",b-this.width/2)):"cy"==a?(this.cy=b,this.height&&this.applyAttr("y",
b-this.height/2)):jvm.SVGImageElement.parentClass.prototype.applyAttr.apply(this,arguments)};jvm.SVGTextElement=function(a,b){jvm.SVGTextElement.parentClass.call(this,"text",a,b)};jvm.inherits(jvm.SVGTextElement,jvm.SVGShapeElement);jvm.SVGTextElement.prototype.applyAttr=function(a,b){"text"===a?this.node.textContent=b:jvm.SVGTextElement.parentClass.prototype.applyAttr.apply(this,arguments)};
jvm.VMLElement=function(){jvm.VMLElement.VMLInitialized||jvm.VMLElement.initializeVML();jvm.VMLElement.parentClass.apply(this,arguments)};jvm.inherits(jvm.VMLElement,jvm.AbstractElement);jvm.VMLElement.VMLInitialized=!1;
jvm.VMLElement.initializeVML=function(){try{document.namespaces.rvml||document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),jvm.VMLElement.prototype.createElement=function(a){return document.createElement("<rvml:"+a+' class="rvml">')}}catch(a){jvm.VMLElement.prototype.createElement=function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");jvm.VMLElement.VMLInitialized=
!0};jvm.VMLElement.prototype.getElementCtr=function(a){return jvm["VML"+a]};jvm.VMLElement.prototype.addClass=function(a){jvm.$(this.node).addClass(a)};jvm.VMLElement.prototype.applyAttr=function(a,b){this.node[a]=b};jvm.VMLElement.prototype.getBBox=function(){var a=jvm.$(this.node);return{x:a.position().left/this.canvas.scale,y:a.position().top/this.canvas.scale,width:a.width()/this.canvas.scale,height:a.height()/this.canvas.scale}};
jvm.VMLGroupElement=function(){jvm.VMLGroupElement.parentClass.call(this,"group");this.node.style.left="0px";this.node.style.top="0px";this.node.coordorigin="0 0"};jvm.inherits(jvm.VMLGroupElement,jvm.VMLElement);jvm.VMLGroupElement.prototype.add=function(a){this.node.appendChild(a.node)};jvm.VMLCanvasElement=function(){this.classPrefix="VML";jvm.VMLCanvasElement.parentClass.call(this,"group");jvm.AbstractCanvasElement.apply(this,arguments);this.node.style.position="absolute"};
jvm.inherits(jvm.VMLCanvasElement,jvm.VMLElement);jvm.mixin(jvm.VMLCanvasElement,jvm.AbstractCanvasElement);
jvm.VMLCanvasElement.prototype.setSize=function(a,b){var c;if(this.width=a,this.height=b,this.node.style.width=a+"px",this.node.style.height=b+"px",this.node.coordsize=a+" "+b,this.node.coordorigin="0 0",this.rootElement){var d=this.rootElement.node.getElementsByTagName("shape");var e=0;for(c=d.length;c>e;e++)d[e].coordsize=a+" "+b,d[e].style.width=a+"px",d[e].style.height=b+"px";d=this.node.getElementsByTagName("group");e=0;for(c=d.length;c>e;e++)d[e].coordsize=a+" "+b,d[e].style.width=a+"px",d[e].style.height=
b+"px"}};jvm.VMLCanvasElement.prototype.applyTransformParams=function(a,b,c){this.scale=a;this.transX=b;this.transY=c;this.rootElement.node.coordorigin=this.width-b-this.width/100+","+(this.height-c-this.height/100);this.rootElement.node.coordsize=this.width/a+","+this.height/a};
jvm.VMLShapeElement=function(a,b){jvm.VMLShapeElement.parentClass.call(this,a,b);this.fillElement=new jvm.VMLElement("fill");this.strokeElement=new jvm.VMLElement("stroke");this.node.appendChild(this.fillElement.node);this.node.appendChild(this.strokeElement.node);this.node.stroked=!1;jvm.AbstractShapeElement.apply(this,arguments)};jvm.inherits(jvm.VMLShapeElement,jvm.VMLElement);jvm.mixin(jvm.VMLShapeElement,jvm.AbstractShapeElement);
jvm.VMLShapeElement.prototype.applyAttr=function(a,b){switch(a){case "fill":this.node.fillcolor=b;break;case "fill-opacity":this.fillElement.node.opacity=Math.round(100*b)+"%";break;case "stroke":this.node.stroked="none"===b?!1:!0;this.node.strokecolor=b;break;case "stroke-opacity":this.strokeElement.node.opacity=Math.round(100*b)+"%";break;case "stroke-width":this.node.stroked=0===parseInt(b,10)?!1:!0;this.node.strokeweight=b;break;case "d":this.node.path=jvm.VMLPathElement.pathSvgToVml(b);break;
default:jvm.VMLShapeElement.parentClass.prototype.applyAttr.apply(this,arguments)}};jvm.VMLPathElement=function(a,b){var c=new jvm.VMLElement("skew");jvm.VMLPathElement.parentClass.call(this,"shape",a,b);this.node.coordorigin="0 0";c.node.on=!0;c.node.matrix="0.01,0,0,0.01,0,0";c.node.offset="0,0";this.node.appendChild(c.node)};jvm.inherits(jvm.VMLPathElement,jvm.VMLShapeElement);
jvm.VMLPathElement.prototype.applyAttr=function(a,b){"d"===a?this.node.path=jvm.VMLPathElement.pathSvgToVml(b):jvm.VMLShapeElement.prototype.applyAttr.call(this,a,b)};
jvm.VMLPathElement.pathSvgToVml=function(a){var b,c,d=0,e=0;return a=a.replace(/(-?\d+)e(-?\d+)/g,"0"),a.replace(/([MmLlHhVvCcSs])\s*((?:-?\d*(?:\.\d+)?\s*,?\s*)+)/g,function(a,k,f){f=f.replace(/(\d)-/g,"$1,-").replace(/^\s+/g,"").replace(/\s+$/g,"").replace(/\s+/g,",").split(",");f[0]||f.shift();a=0;for(var g=f.length;g>a;a++)f[a]=Math.round(100*f[a]);switch(k){case "m":return d+=f[0],e+=f[1],"t"+f.join(",");case "M":return d=f[0],e=f[1],"m"+f.join(",");case "l":return d+=f[0],e+=f[1],"r"+f.join(",");
case "L":return d=f[0],e=f[1],"l"+f.join(",");case "h":return d+=f[0],"r"+f[0]+",0";case "H":return d=f[0],"l"+d+","+e;case "v":return e+=f[0],"r0,"+f[0];case "V":return e=f[0],"l"+d+","+e;case "c":return b=d+f[f.length-4],c=e+f[f.length-3],d+=f[f.length-2],e+=f[f.length-1],"v"+f.join(",");case "C":return b=f[f.length-4],c=f[f.length-3],d=f[f.length-2],e=f[f.length-1],"c"+f.join(",");case "s":return f.unshift(e-c),f.unshift(d-b),b=d+f[f.length-4],c=e+f[f.length-3],d+=f[f.length-2],e+=f[f.length-1],
"v"+f.join(",");case "S":return f.unshift(e+e-c),f.unshift(d+d-b),b=f[f.length-4],c=f[f.length-3],d=f[f.length-2],e=f[f.length-1],"c"+f.join(",")}return""}).replace(/z/g,"e")};jvm.VMLCircleElement=function(a,b){jvm.VMLCircleElement.parentClass.call(this,"oval",a,b)};jvm.inherits(jvm.VMLCircleElement,jvm.VMLShapeElement);
jvm.VMLCircleElement.prototype.applyAttr=function(a,b){switch(a){case "r":this.node.style.width=2*b+"px";this.node.style.height=2*b+"px";this.applyAttr("cx",this.get("cx")||0);this.applyAttr("cy",this.get("cy")||0);break;case "cx":if(!b)break;this.node.style.left=b-(this.get("r")||0)+"px";break;case "cy":if(!b)break;this.node.style.top=b-(this.get("r")||0)+"px";break;default:jvm.VMLCircleElement.parentClass.prototype.applyAttr.call(this,a,b)}};
jvm.VectorCanvas=function(a,b,c){return this.mode=window.SVGAngle?"svg":"vml",this.impl="svg"==this.mode?new jvm.SVGCanvasElement(a,b,c):new jvm.VMLCanvasElement(a,b,c),this.impl.mode=this.mode,this.impl};jvm.SimpleScale=function(a){this.scale=a};jvm.SimpleScale.prototype.getValue=function(a){return a};jvm.OrdinalScale=function(a){this.scale=a};jvm.OrdinalScale.prototype.getValue=function(a){return this.scale[a]};
jvm.OrdinalScale.prototype.getTicks=function(){var a,b=[];for(a in this.scale)b.push({label:a,value:this.scale[a]});return b};jvm.NumericScale=function(a,b,c,d){this.scale=[];b=b||"linear";a&&this.setScale(a);b&&this.setNormalizeFunction(b);"undefined"!=typeof c&&this.setMin(c);"undefined"!=typeof d&&this.setMax(d)};
jvm.NumericScale.prototype={setMin:function(a){this.clearMinValue=a;this.minValue="function"==typeof this.normalize?this.normalize(a):a},setMax:function(a){this.clearMaxValue=a;this.maxValue="function"==typeof this.normalize?this.normalize(a):a},setScale:function(a){var b;this.scale=[];for(b=0;b<a.length;b++)this.scale[b]=[a[b]]},setNormalizeFunction:function(a){"polynomial"===a?this.normalize=function(a){return Math.pow(a,.2)}:"linear"===a?delete this.normalize:this.normalize=a;this.setMin(this.clearMinValue);
this.setMax(this.clearMaxValue)},getValue:function(a){var b=[],c=0,d;"function"==typeof this.normalize&&(a=this.normalize(a));for(d=0;d<this.scale.length-1;d++){var e=this.vectorLength(this.vectorSubtract(this.scale[d+1],this.scale[d]));b.push(e);c+=e}e=(this.maxValue-this.minValue)/c;for(d=0;d<b.length;d++)b[d]*=e;d=0;for(a-=this.minValue;0<=a-b[d];)a-=b[d],d++;return this.vectorToNum(d==this.scale.length-1?this.scale[d]:this.vectorAdd(this.scale[d],this.vectorMult(this.vectorSubtract(this.scale[d+
1],this.scale[d]),a/b[d])))},vectorToNum:function(a){var b,c=0;for(b=0;b<a.length;b++)c+=Math.round(a[b])*Math.pow(256,a.length-b-1);return c},vectorSubtract:function(a,b){var c,d=[];for(c=0;c<a.length;c++)d[c]=a[c]-b[c];return d},vectorAdd:function(a,b){var c,d=[];for(c=0;c<a.length;c++)d[c]=a[c]+b[c];return d},vectorMult:function(a,b){var c,d=[];for(c=0;c<a.length;c++)d[c]=a[c]*b;return d},vectorLength:function(a){var b,c=0;for(b=0;b<a.length;b++)c+=a[b]*a[b];return Math.sqrt(c)},getTicks:function(){var a=
[this.clearMinValue,this.clearMaxValue],b=a[1]-a[0],c=Math.pow(10,Math.floor(Math.log(b/5)/Math.LN10));var d=5/b*c;b=[];.15>=d?c*=10:.35>=d?c*=5:.75>=d&&(c*=2);a[0]=Math.floor(a[0]/c)*c;a[1]=Math.ceil(a[1]/c)*c;for(d=a[0];d<=a[1];){var e=d==a[0]?this.clearMinValue:d==a[1]?this.clearMaxValue:d;b.push({label:d,value:this.getValue(e)});d+=c}return b}};jvm.ColorScale=function(){jvm.ColorScale.parentClass.apply(this,arguments)};jvm.inherits(jvm.ColorScale,jvm.NumericScale);
jvm.ColorScale.prototype.setScale=function(a){var b;for(b=0;b<a.length;b++)this.scale[b]=jvm.ColorScale.rgbToArray(a[b])};jvm.ColorScale.prototype.getValue=function(a){return jvm.ColorScale.numToRgb(jvm.ColorScale.parentClass.prototype.getValue.call(this,a))};jvm.ColorScale.arrayToRgb=function(a){var b,c="#";for(b=0;b<a.length;b++){var d=a[b].toString(16);c+=1==d.length?"0"+d:d}return c};jvm.ColorScale.numToRgb=function(a){for(a=a.toString(16);6>a.length;)a="0"+a;return"#"+a};
jvm.ColorScale.rgbToArray=function(a){return a=a.substr(1),[parseInt(a.substr(0,2),16),parseInt(a.substr(2,2),16),parseInt(a.substr(4,2),16)]};jvm.Legend=function(a){this.params=a||{};this.map=this.params.map;this.series=this.params.series;this.body=jvm.$("<div/>");this.body.addClass("jvectormap-legend");this.params.cssClass&&this.body.addClass(this.params.cssClass);a.vertical?this.map.legendCntVertical.append(this.body):this.map.legendCntHorizontal.append(this.body);this.render()};
jvm.Legend.prototype.render=function(){var a,b,c,d=this.series.scale.getTicks(),e=jvm.$("<div/>").addClass("jvectormap-legend-inner");this.body.html("");this.params.title&&this.body.append(jvm.$("<div/>").addClass("jvectormap-legend-title").html(this.params.title));this.body.append(e);for(a=0;a<d.length;a++){switch(b=jvm.$("<div/>").addClass("jvectormap-legend-tick"),c=jvm.$("<div/>").addClass("jvectormap-legend-tick-sample"),this.series.params.attribute){case "fill":jvm.isImageUrl(d[a].value)?c.css("background",
"url("+d[a].value+")"):c.css("background",d[a].value);break;case "stroke":c.css("background",d[a].value);break;case "image":c.css("background","url("+d[a].value+") no-repeat center center");break;case "r":jvm.$("<div/>").css({"border-radius":d[a].value,border:this.map.params.markerStyle.initial["stroke-width"]+"px "+this.map.params.markerStyle.initial.stroke+" solid",width:2*d[a].value+"px",height:2*d[a].value+"px",background:this.map.params.markerStyle.initial.fill}).appendTo(c)}b.append(c);c=d[a].label;
this.params.labelRender&&(c=this.params.labelRender(c));b.append(jvm.$("<div>"+c+" </div>").addClass("jvectormap-legend-tick-text"));e.append(b)}e.append(jvm.$("<div/>").css("clear","both"))};
jvm.DataSeries=function(a,b,c){var d;a=a||{};a.attribute=a.attribute||"fill";this.elements=b;this.params=a;this.map=c;a.attributes&&this.setAttributes(a.attributes);jvm.$.isArray(a.scale)?(d="fill"===a.attribute||"stroke"===a.attribute?jvm.ColorScale:jvm.NumericScale,this.scale=new d(a.scale,a.normalizeFunction,a.min,a.max)):this.scale=a.scale?new jvm.OrdinalScale(a.scale):new jvm.SimpleScale(a.scale);this.values=a.values||{};this.setValues(this.values);this.params.legend&&(this.legend=new jvm.Legend($.extend({map:this.map,
series:this},this.params.legend)))};
jvm.DataSeries.prototype={setAttributes:function(a,b){var c;if("string"==typeof a)this.elements[a]&&this.elements[a].setStyle(this.params.attribute,b);else for(c in a)this.elements[c]&&this.elements[c].element.setStyle(this.params.attribute,a[c])},setValues:function(a){var b,c=-Number.MAX_VALUE,d=Number.MAX_VALUE,e={};if(this.scale instanceof jvm.OrdinalScale||this.scale instanceof jvm.SimpleScale)for(b in a)e[b]=a[b]?this.scale.getValue(a[b]):this.elements[b].element.style.initial[this.params.attribute];else{if("undefined"==
typeof this.params.min||"undefined"==typeof this.params.max)for(b in a){var g=parseFloat(a[b]);g>c&&(c=g);d>g&&(d=g)}"undefined"==typeof this.params.min?(this.scale.setMin(d),this.params.min=d):this.scale.setMin(this.params.min);"undefined"==typeof this.params.max?(this.scale.setMax(c),this.params.max=c):this.scale.setMax(this.params.max);for(b in a)"indexOf"!=b&&(g=parseFloat(a[b]),e[b]=isNaN(g)?this.elements[b].element.style.initial[this.params.attribute]:this.scale.getValue(g))}this.setAttributes(e);
jvm.$.extend(this.values,a)},clear:function(){var a,b={};for(a in this.values)this.elements[a]&&(b[a]=this.elements[a].element.shape.style.initial[this.params.attribute]);this.setAttributes(b);this.values={}},setScale:function(a){this.scale.setScale(a);this.values&&this.setValues(this.values)},setNormalizeFunction:function(a){this.scale.setNormalizeFunction(a);this.values&&this.setValues(this.values)}};
jvm.Proj={degRad:180/Math.PI,radDeg:Math.PI/180,radius:6381372,sgn:function(a){return 0<a?1:0>a?-1:a},mill:function(a,b,c){return{x:this.radius*(b-c)*this.radDeg,y:-this.radius*Math.log(Math.tan((45+.4*a)*this.radDeg))/.8}},mill_inv:function(a,b,c){return{lat:(2.5*Math.atan(Math.exp(.8*b/this.radius))-5*Math.PI/8)*this.degRad,lng:(c*this.radDeg+a/this.radius)*this.degRad}},merc:function(a,b,c){return{x:this.radius*(b-c)*this.radDeg,y:-this.radius*Math.log(Math.tan(Math.PI/4+a*Math.PI/360))}},merc_inv:function(a,
b,c){return{lat:(2*Math.atan(Math.exp(b/this.radius))-Math.PI/2)*this.degRad,lng:(c*this.radDeg+a/this.radius)*this.degRad}},aea:function(a,b,c){var d=29.5*this.radDeg,e=(Math.sin(d)+Math.sin(45.5*this.radDeg))/2;d=Math.cos(d)*Math.cos(d)+2*e*Math.sin(d);b=e*(b*this.radDeg-c*this.radDeg);a=Math.sqrt(d-2*e*Math.sin(a*this.radDeg))/e;return{x:a*Math.sin(b)*this.radius,y:-(Math.sqrt(d-2*e*Math.sin(0))/e-a*Math.cos(b))*this.radius}},aea_inv:function(a,b,c){a/=this.radius;b/=this.radius;var d=29.5*this.radDeg,
e=(Math.sin(d)+Math.sin(45.5*this.radDeg))/2;d=Math.cos(d)*Math.cos(d)+2*e*Math.sin(d);var g=Math.sqrt(d-2*e*Math.sin(0))/e,k=Math.sqrt(a*a+(g-b)*(g-b));return{lat:Math.asin((d-k*k*e*e)/(2*e))*this.degRad,lng:(c*this.radDeg+Math.atan(a/(g-b))/e)*this.degRad}},lcc:function(a,b,c){c*=this.radDeg;b*=this.radDeg;var d=33*this.radDeg,e=45*this.radDeg;e=Math.log(1/Math.cos(e)*Math.cos(d))/Math.log(1/Math.tan(Math.PI/4+d/2)*Math.tan(Math.PI/4+e/2));d=Math.cos(d)*Math.pow(Math.tan(Math.PI/4+d/2),e)/e;a=d*
Math.pow(1/Math.tan(Math.PI/4+a*this.radDeg/2),e);return{x:a*Math.sin(e*(b-c))*this.radius,y:-(d*Math.pow(1/Math.tan(Math.PI/4),e)-a*Math.cos(e*(b-c)))*this.radius}},lcc_inv:function(a,b,c){a/=this.radius;b/=this.radius;c*=this.radDeg;var d=33*this.radDeg,e=45*this.radDeg;e=Math.log(1/Math.cos(e)*Math.cos(d))/Math.log(1/Math.tan(Math.PI/4+d/2)*Math.tan(Math.PI/4+e/2));d=Math.cos(d)*Math.pow(Math.tan(Math.PI/4+d/2),e)/e;var g=d*Math.pow(1/Math.tan(Math.PI/4),e),k=this.sgn(e)*Math.sqrt(a*a+(g-b)*(g-
b));return{lat:(2*Math.atan(Math.pow(d/k,1/e))-Math.PI/2)*this.degRad,lng:(c+Math.atan(a/(g-b))/e)*this.degRad}}};jvm.MapObject=function(){};jvm.MapObject.prototype.getLabelText=function(a){return this.config.label?"function"==typeof this.config.label.render?this.config.label.render(a):a:null};
jvm.MapObject.prototype.getLabelOffsets=function(a){var b;return this.config.label&&("function"==typeof this.config.label.offsets?b=this.config.label.offsets(a):"object"==typeof this.config.label.offsets&&(b=this.config.label.offsets[a])),b||[0,0]};jvm.MapObject.prototype.setHovered=function(a){this.isHovered!==a&&(this.isHovered=a,this.shape.isHovered=a,this.shape.updateStyle(),this.label&&(this.label.isHovered=a,this.label.updateStyle()))};
jvm.MapObject.prototype.setSelected=function(a){this.isSelected!==a&&(this.isSelected=a,this.shape.isSelected=a,this.shape.updateStyle(),this.label&&(this.label.isSelected=a,this.label.updateStyle()),jvm.$(this.shape).trigger("selected",[a]))};jvm.MapObject.prototype.setStyle=function(){this.shape.setStyle.apply(this.shape,arguments)};jvm.MapObject.prototype.remove=function(){this.shape.remove();this.label&&this.label.remove()};
jvm.Region=function(a){var b;this.config=a;this.map=this.config.map;this.shape=a.canvas.addPath({d:a.path,"data-code":a.code},a.style,a.canvas.rootElement);this.shape.addClass("jvectormap-region jvectormap-element");var c=this.shape.getBBox();var d=this.getLabelText(a.code);this.config.label&&d&&(b=this.getLabelOffsets(a.code),this.labelX=c.x+c.width/2+b[0],this.labelY=c.y+c.height/2+b[1],this.label=a.canvas.addText({text:d,"text-anchor":"middle","alignment-baseline":"central",x:this.labelX,y:this.labelY,
"data-code":a.code},a.labelStyle,a.labelsGroup),this.label.addClass("jvectormap-region jvectormap-element"))};jvm.inherits(jvm.Region,jvm.MapObject);jvm.Region.prototype.updateLabelPosition=function(){this.label&&this.label.set({x:this.labelX*this.map.scale+this.map.transX*this.map.scale,y:this.labelY*this.map.scale+this.map.transY*this.map.scale})};
jvm.Marker=function(a){this.config=a;this.map=this.config.map;this.isImage=!!this.config.style.initial.image;this.createShape();var b=this.getLabelText(a.index);this.config.label&&b&&(this.offsets=this.getLabelOffsets(a.index),this.labelX=a.cx/this.map.scale-this.map.transX,this.labelY=a.cy/this.map.scale-this.map.transY,this.label=a.canvas.addText({text:b,"data-index":a.index,dy:"0.6ex",x:this.labelX,y:this.labelY},a.labelStyle,a.labelsGroup),this.label.addClass("jvectormap-marker jvectormap-element"))};
jvm.inherits(jvm.Marker,jvm.MapObject);jvm.Marker.prototype.createShape=function(){var a=this;this.shape&&this.shape.remove();this.shape=this.config.canvas[this.isImage?"addImage":"addCircle"]({"data-index":this.config.index,cx:this.config.cx,cy:this.config.cy},this.config.style,this.config.group);this.shape.addClass("jvectormap-marker jvectormap-element");this.isImage&&jvm.$(this.shape.node).on("imageloaded",function(){a.updateLabelPosition()})};
jvm.Marker.prototype.updateLabelPosition=function(){this.label&&this.label.set({x:this.labelX*this.map.scale+this.offsets[0]+this.map.transX*this.map.scale+5+(this.isImage?(this.shape.width||0)/2:this.shape.properties.r),y:this.labelY*this.map.scale+this.map.transY*this.map.scale+this.offsets[1]})};
jvm.Marker.prototype.setStyle=function(a){jvm.Marker.parentClass.prototype.setStyle.apply(this,arguments);"r"===a&&this.updateLabelPosition();var b=!!this.shape.get("image");b!=this.isImage&&(this.isImage=b,this.config.style=jvm.$.extend(!0,{},this.shape.style),this.createShape())};
jvm.Map=function(a){var b,c=this;if(this.params=jvm.$.extend(!0,{},jvm.Map.defaultParams,a),!jvm.Map.maps[this.params.map])throw Error("Attempt to use map which was not loaded: "+this.params.map);this.mapData=jvm.Map.maps[this.params.map];this.markers={};this.regions={};this.regionsColors={};this.regionsData={};this.container=jvm.$("<div>").addClass("jvectormap-container");this.params.container&&this.params.container.append(this.container);this.container.data("mapObject",this);this.defaultWidth=this.mapData.width;
this.defaultHeight=this.mapData.height;this.setBackgroundColor(this.params.backgroundColor);this.onResize=function(){c.updateSize()};jvm.$(window).resize(this.onResize);for(b in jvm.Map.apiEvents)this.params[b]&&this.container.bind(jvm.Map.apiEvents[b]+".jvectormap",this.params[b]);this.canvas=new jvm.VectorCanvas(this.container[0],this.width,this.height);this.params.bindTouchEvents&&("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?this.bindContainerTouchEvents():
window.MSGesture&&this.bindContainerPointerEvents());this.bindContainerEvents();this.bindElementEvents();this.createTip();this.params.zoomButtons&&this.bindZoomButtons();this.createRegions();this.createMarkers(this.params.markers||{});this.updateSize();this.params.focusOn&&("string"==typeof this.params.focusOn?this.params.focusOn={region:this.params.focusOn}:jvm.$.isArray(this.params.focusOn)&&(this.params.focusOn={regions:this.params.focusOn}),this.setFocus(this.params.focusOn));this.params.selectedRegions&&
this.setSelectedRegions(this.params.selectedRegions);this.params.selectedMarkers&&this.setSelectedMarkers(this.params.selectedMarkers);this.legendCntHorizontal=jvm.$("<div/>").addClass("jvectormap-legend-cnt jvectormap-legend-cnt-h");this.legendCntVertical=jvm.$("<div/>").addClass("jvectormap-legend-cnt jvectormap-legend-cnt-v");this.container.append(this.legendCntHorizontal);this.container.append(this.legendCntVertical);this.params.series&&this.createSeries()};
jvm.Map.prototype={transX:0,transY:0,scale:1,baseTransX:0,baseTransY:0,baseScale:1,width:0,height:0,setBackgroundColor:function(a){this.container.css("background-color",a)},resize:function(){var a=this.baseScale;this.width/this.height>this.defaultWidth/this.defaultHeight?(this.baseScale=this.height/this.defaultHeight,this.baseTransX=Math.abs(this.width-this.defaultWidth*this.baseScale)/(2*this.baseScale)):(this.baseScale=this.width/this.defaultWidth,this.baseTransY=Math.abs(this.height-this.defaultHeight*
this.baseScale)/(2*this.baseScale));this.scale*=this.baseScale/a;this.transX*=this.baseScale/a;this.transY*=this.baseScale/a},updateSize:function(){this.width=this.container.width();this.height=this.container.height();this.resize();this.canvas.setSize(this.width,this.height);this.applyTransform()},reset:function(){var a,b;for(a in this.series)for(b=0;b<this.series[a].length;b++)this.series[a][b].clear();this.scale=this.baseScale;this.transX=this.baseTransX;this.transY=this.baseTransY;this.applyTransform()},
applyTransform:function(){var a,b,c,d;this.defaultWidth*this.scale<=this.width?(a=(this.width-this.defaultWidth*this.scale)/(2*this.scale),c=(this.width-this.defaultWidth*this.scale)/(2*this.scale)):(a=0,c=(this.width-this.defaultWidth*this.scale)/this.scale);this.defaultHeight*this.scale<=this.height?(b=(this.height-this.defaultHeight*this.scale)/(2*this.scale),d=(this.height-this.defaultHeight*this.scale)/(2*this.scale)):(b=0,d=(this.height-this.defaultHeight*this.scale)/this.scale);this.transY>
b?this.transY=b:this.transY<d&&(this.transY=d);this.transX>a?this.transX=a:this.transX<c&&(this.transX=c);this.canvas.applyTransformParams(this.scale,this.transX,this.transY);this.markers&&this.repositionMarkers();this.repositionLabels();this.container.trigger("viewportChange",[this.scale/this.baseScale,this.transX,this.transY])},bindContainerEvents:function(){var a,b,c=!1,d=this;this.params.panOnDrag&&(this.container.mousemove(function(e){return c&&(d.transX-=(a-e.pageX)/d.scale,d.transY-=(b-e.pageY)/
d.scale,d.applyTransform(),a=e.pageX,b=e.pageY),!1}).mousedown(function(d){return c=!0,a=d.pageX,b=d.pageY,!1}),this.onContainerMouseUp=function(){c=!1},jvm.$("body").mouseup(this.onContainerMouseUp));this.params.zoomOnScroll&&this.container.mousewheel(function(a){var b=jvm.$(d.container).offset(),c=a.pageX-b.left;b=a.pageY-b.top;var e=Math.pow(1+d.params.zoomOnScrollSpeed/1E3,a.deltaFactor*a.deltaY);d.tip.hide();d.setScale(d.scale*e,c,b);a.preventDefault()})},bindContainerTouchEvents:function(){var a,
b,c,d,e,g,k,f=this,m=function(m){var n,p,r,t,h=m.originalEvent.touches;"touchstart"==m.type&&(k=0);1==h.length?(1==k&&(r=f.transX,t=f.transY,f.transX-=(c-h[0].pageX)/f.scale,f.transY-=(d-h[0].pageY)/f.scale,f.applyTransform(),f.tip.hide(),(r!=f.transX||t!=f.transY)&&m.preventDefault()),c=h[0].pageX,d=h[0].pageY):2==h.length&&(2==k?(p=Math.sqrt(Math.pow(h[0].pageX-h[1].pageX,2)+Math.pow(h[0].pageY-h[1].pageY,2))/b,f.setScale(a*p,e,g),f.tip.hide(),m.preventDefault()):(n=jvm.$(f.container).offset(),
e=h[0].pageX>h[1].pageX?h[1].pageX+(h[0].pageX-h[1].pageX)/2:h[0].pageX+(h[1].pageX-h[0].pageX)/2,g=h[0].pageY>h[1].pageY?h[1].pageY+(h[0].pageY-h[1].pageY)/2:h[0].pageY+(h[1].pageY-h[0].pageY)/2,e-=n.left,g-=n.top,a=f.scale,b=Math.sqrt(Math.pow(h[0].pageX-h[1].pageX,2)+Math.pow(h[0].pageY-h[1].pageY,2))));k=h.length};jvm.$(this.container).bind("touchstart",m);jvm.$(this.container).bind("touchmove",m)},bindContainerPointerEvents:function(){var a=this,b=new MSGesture,c=this.container[0];b.target=c;
c.addEventListener("MSGestureChange",function(b){var c,d;0==b.translationX&&0==b.translationY||(c=a.transX,d=a.transY,a.transX+=b.translationX/a.scale,a.transY+=b.translationY/a.scale,a.applyTransform(),a.tip.hide(),c==a.transX&&d==a.transY||b.preventDefault());1!=b.scale&&(a.setScale(a.scale*b.scale,b.offsetX,b.offsetY),a.tip.hide(),b.preventDefault())},!1);c.addEventListener("pointerdown",function(a){b.addPointer(a.pointerId)},!1)},bindElementEvents:function(){var a,b,c,d=this;this.container.mousemove(function(d){2<
Math.abs(a-d.pageX)+Math.abs(b-d.pageY)&&(c=!0)});this.container.delegate("[class~='jvectormap-element']","mouseover mouseout",function(a){var b=-1===(jvm.$(this).attr("class").baseVal||jvm.$(this).attr("class")).indexOf("jvectormap-region")?"marker":"region",c=jvm.$(this).attr("region"==b?"data-code":"data-index"),e="region"==b?d.regions[c].element:d.markers[c].element,m="region"==b?d.mapData.paths[c].name:d.markers[c].config.name||"",p=jvm.$.Event(b+"TipShow.jvectormap"),n=jvm.$.Event(b+"Over.jvectormap");
"mouseover"==a.type?(d.container.trigger(n,[c]),n.isDefaultPrevented()||e.setHovered(!0),d.tip.text(m),d.container.trigger(p,[d.tip,c]),p.isDefaultPrevented()||(d.tip.show(),d.tipWidth=d.tip.width(),d.tipHeight=d.tip.height())):(e.setHovered(!1),d.tip.hide(),d.container.trigger(b+"Out.jvectormap",[c]))});this.container.delegate("[class~='jvectormap-element']","mousedown",function(d){a=d.pageX;b=d.pageY;c=!1});this.container.delegate("[class~='jvectormap-element']","mouseup",function(){var a=-1===
(jvm.$(this).attr("class").baseVal?jvm.$(this).attr("class").baseVal:jvm.$(this).attr("class")).indexOf("jvectormap-region")?"marker":"region",b=jvm.$(this).attr("region"==a?"data-code":"data-index"),k=jvm.$.Event(a+"Click.jvectormap"),f="region"==a?d.regions[b].element:d.markers[b].element;c||(d.container.trigger(k,[b]),("region"===a&&d.params.regionsSelectable||"marker"===a&&d.params.markersSelectable)&&(k.isDefaultPrevented()||(d.params[a+"sSelectableOne"]&&d.clearSelected(a+"s"),f.setSelected(!f.isSelected))))})},
bindZoomButtons:function(){var a=this;jvm.$("<div/>").addClass("jvectormap-zoomin").text("+").appendTo(this.container);jvm.$("<div/>").addClass("jvectormap-zoomout").html("&#x2212;").appendTo(this.container);this.container.find(".jvectormap-zoomin").click(function(){a.setScale(a.scale*a.params.zoomStep,a.width/2,a.height/2,!1,a.params.zoomAnimate)});this.container.find(".jvectormap-zoomout").click(function(){a.setScale(a.scale/a.params.zoomStep,a.width/2,a.height/2,!1,a.params.zoomAnimate)})},createTip:function(){var a=
this;this.tip=jvm.$("<div/>").addClass("jvectormap-tip").appendTo(jvm.$("body"));this.container.mousemove(function(b){var c=b.pageX-15-a.tipWidth,d=b.pageY-15-a.tipHeight;5>c&&(c=b.pageX+15);5>d&&(d=b.pageY+15);a.tip.css({left:c,top:d})})},setScale:function(a,b,c,d,e){var g,k,f,m,p,n,w,r,t,h=jvm.$.Event("zoom.jvectormap"),l=this,u=0,q=Math.abs(Math.round(60*(a-this.scale)/Math.max(a,this.scale))),v=new jvm.$.Deferred;return a>this.params.zoomMax*this.baseScale?a=this.params.zoomMax*this.baseScale:
a<this.params.zoomMin*this.baseScale&&(a=this.params.zoomMin*this.baseScale),"undefined"!=typeof b&&"undefined"!=typeof c&&(zoomStep=a/this.scale,d?(r=b+this.width/(this.defaultWidth*a)*this.defaultWidth/2,t=c+this.height/(this.defaultHeight*a)*this.defaultHeight/2):(r=this.transX-(zoomStep-1)/a*b,t=this.transY-(zoomStep-1)/a*c)),e&&0<q?(k=this.scale,f=(a-k)/q,m=this.transX*this.scale,n=this.transY*this.scale,p=(r*a-m)/q,w=(t*a-n)/q,g=setInterval(function(){u+=1;l.scale=k+f*u;l.transX=(m+p*u)/l.scale;
l.transY=(n+w*u)/l.scale;l.applyTransform();u==q&&(clearInterval(g),l.container.trigger(h,[a/l.baseScale]),v.resolve())},10)):(this.transX=r,this.transY=t,this.scale=a,this.applyTransform(),this.container.trigger(h,[a/this.baseScale]),v.resolve()),v},setFocus:function(a){var b,c,d,e,g;if(a=a||{},a.region?e=[a.region]:a.regions&&(e=a.regions),e){for(g=0;g<e.length;g++)this.regions[e[g]]&&(c=this.regions[e[g]].element.shape.getBBox(),c&&("undefined"==typeof b?b=c:(d={x:Math.min(b.x,c.x),y:Math.min(b.y,
c.y),width:Math.max(b.x+b.width,c.x+c.width)-Math.min(b.x,c.x),height:Math.max(b.y+b.height,c.y+c.height)-Math.min(b.y,c.y)},b=d)));return this.setScale(Math.min(this.width/b.width,this.height/b.height),-(b.x+b.width/2),-(b.y+b.height/2),!0,a.animate)}return a.lat&&a.lng?(g=this.latLngToPoint(a.lat,a.lng),a.x=this.transX-g.x/this.scale,a.y=this.transY-g.y/this.scale):a.x&&a.y&&(a.x*=-this.defaultWidth,a.y*=-this.defaultHeight),this.setScale(a.scale*this.baseScale,a.x,a.y,!0,a.animate)},getSelected:function(a){var b,
c=[];for(b in this[a])this[a][b].element.isSelected&&c.push(b);return c},getSelectedRegions:function(){return this.getSelected("regions")},getSelectedMarkers:function(){return this.getSelected("markers")},setSelected:function(a,b){var c;if("object"!=typeof b&&(b=[b]),jvm.$.isArray(b))for(c=0;c<b.length;c++)this[a][b[c]].element.setSelected(!0);else for(c in b)this[a][c].element.setSelected(!!b[c])},setSelectedRegions:function(a){this.setSelected("regions",a)},setSelectedMarkers:function(a){this.setSelected("markers",
a)},clearSelected:function(a){var b,c={},d=this.getSelected(a);for(b=0;b<d.length;b++)c[d[b]]=!1;this.setSelected(a,c)},clearSelectedRegions:function(){this.clearSelected("regions")},clearSelectedMarkers:function(){this.clearSelected("markers")},getMapObject:function(){return this},getRegionName:function(a){return this.mapData.paths[a].name},createRegions:function(){var a,b=this;this.regionLabelsGroup=this.regionLabelsGroup||this.canvas.addGroup();for(a in this.mapData.paths){var c=new jvm.Region({map:this,
path:this.mapData.paths[a].path,code:a,style:jvm.$.extend(!0,{},this.params.regionStyle),labelStyle:jvm.$.extend(!0,{},this.params.regionLabelStyle),canvas:this.canvas,labelsGroup:this.regionLabelsGroup,label:"vml"!=this.canvas.mode?this.params.labels&&this.params.labels.regions:null});jvm.$(c.shape).bind("selected",function(a,c){b.container.trigger("regionSelected.jvectormap",[jvm.$(this.node).attr("data-code"),c,b.getSelectedRegions()])});this.regions[a]={element:c,config:this.mapData.paths[a]}}},
createMarkers:function(a){var b,c,d=this;if(this.markersGroup=this.markersGroup||this.canvas.addGroup(),this.markerLabelsGroup=this.markerLabelsGroup||this.canvas.addGroup(),jvm.$.isArray(a)){var e=a.slice();a={};for(b=0;b<e.length;b++)a[b]=e[b]}for(b in a){var g=a[b]instanceof Array?{latLng:a[b]}:a[b];e=this.getMarkerPosition(g);!1!==e&&(c=new jvm.Marker({map:this,style:jvm.$.extend(!0,{},this.params.markerStyle,{initial:g.style||{}}),labelStyle:jvm.$.extend(!0,{},this.params.markerLabelStyle),index:b,
cx:e.x,cy:e.y,group:this.markersGroup,canvas:this.canvas,labelsGroup:this.markerLabelsGroup,label:"vml"!=this.canvas.mode?this.params.labels&&this.params.labels.markers:null}),jvm.$(c.shape).bind("selected",function(a,b){d.container.trigger("markerSelected.jvectormap",[jvm.$(this.node).attr("data-index"),b,d.getSelectedMarkers()])}),this.markers[b]&&this.removeMarkers([b]),this.markers[b]={element:c,config:g})}},repositionMarkers:function(){var a;for(a in this.markers){var b=this.getMarkerPosition(this.markers[a].config);
!1!==b&&this.markers[a].element.setStyle({cx:b.x,cy:b.y})}},repositionLabels:function(){for(var a in this.regions)this.regions[a].element.updateLabelPosition();for(a in this.markers)this.markers[a].element.updateLabelPosition()},getMarkerPosition:function(a){return jvm.Map.maps[this.params.map].projection?this.latLngToPoint.apply(this,a.latLng||[0,0]):{x:a.coords[0]*this.scale+this.transX*this.scale,y:a.coords[1]*this.scale+this.transY*this.scale}},addMarker:function(a,b,c){var d,e={},g=[];c=c||[];
e[a]=b;for(d=0;d<c.length;d++)b={},"undefined"!=typeof c[d]&&(b[a]=c[d]),g.push(b);this.addMarkers(e,g)},addMarkers:function(a,b){var c;b=b||[];this.createMarkers(a);for(c=0;c<b.length;c++)this.series.markers[c].setValues(b[c]||{})},removeMarkers:function(a){var b;for(b=0;b<a.length;b++)this.markers[a[b]].element.remove(),delete this.markers[a[b]]},removeAllMarkers:function(){var a,b=[];for(a in this.markers)b.push(a);this.removeMarkers(b)},latLngToPoint:function(a,b){var c,d,e,g=jvm.Map.maps[this.params.map].projection,
k=g.centralMeridian;return-180+k>b&&(b+=360),c=jvm.Proj[g.type](a,b,k),d=this.getInsetForPoint(c.x,c.y),d?(e=d.bbox,c.x=(c.x-e[0].x)/(e[1].x-e[0].x)*d.width*this.scale,c.y=(c.y-e[0].y)/(e[1].y-e[0].y)*d.height*this.scale,{x:c.x+this.transX*this.scale+d.left*this.scale,y:c.y+this.transY*this.scale+d.top*this.scale}):!1},pointToLatLng:function(a,b){var c,d,e,g,k,f=jvm.Map.maps[this.params.map].projection,m=f.centralMeridian,p=jvm.Map.maps[this.params.map].insets;for(c=0;c<p.length;c++)if(d=p[c],e=d.bbox,
g=a-(this.transX*this.scale+d.left*this.scale),k=b-(this.transY*this.scale+d.top*this.scale),g=g/(d.width*this.scale)*(e[1].x-e[0].x)+e[0].x,k=k/(d.height*this.scale)*(e[1].y-e[0].y)+e[0].y,g>e[0].x&&g<e[1].x&&k>e[0].y&&k<e[1].y)return jvm.Proj[f.type+"_inv"](g,-k,m);return!1},getInsetForPoint:function(a,b){var c,d,e=jvm.Map.maps[this.params.map].insets;for(c=0;c<e.length;c++)if(d=e[c].bbox,a>d[0].x&&a<d[1].x&&b>d[0].y&&b<d[1].y)return e[c]},createSeries:function(){var a,b;this.series={markers:[],
regions:[]};for(b in this.params.series)for(a=0;a<this.params.series[b].length;a++)this.series[b][a]=new jvm.DataSeries(this.params.series[b][a],this[b],this)},remove:function(){this.tip.remove();this.container.remove();jvm.$(window).unbind("resize",this.onResize);jvm.$("body").unbind("mouseup",this.onContainerMouseUp)}};jvm.Map.maps={};
jvm.Map.defaultParams={map:"world_mill_en",backgroundColor:"#505050",zoomButtons:!0,zoomOnScroll:!0,zoomOnScrollSpeed:3,panOnDrag:!0,zoomMax:8,zoomMin:1,zoomStep:1.6,zoomAnimate:!0,regionsSelectable:!1,markersSelectable:!1,bindTouchEvents:!0,regionStyle:{initial:{fill:"white","fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":1},hover:{"fill-opacity":.8,cursor:"pointer"},selected:{fill:"yellow"},selectedHover:{}},regionLabelStyle:{initial:{"font-family":"Verdana","font-size":"12","font-weight":"bold",
cursor:"default",fill:"black"},hover:{cursor:"pointer"}},markerStyle:{initial:{fill:"grey",stroke:"#505050","fill-opacity":1,"stroke-width":1,"stroke-opacity":1,r:5},hover:{stroke:"black","stroke-width":2,cursor:"pointer"},selected:{fill:"blue"},selectedHover:{}},markerLabelStyle:{initial:{"font-family":"Verdana","font-size":"12","font-weight":"bold",cursor:"default",fill:"black"},hover:{cursor:"pointer"}}};
jvm.Map.apiEvents={onRegionTipShow:"regionTipShow",onRegionOver:"regionOver",onRegionOut:"regionOut",onRegionClick:"regionClick",onRegionSelected:"regionSelected",onMarkerTipShow:"markerTipShow",onMarkerOver:"markerOver",onMarkerOut:"markerOut",onMarkerClick:"markerClick",onMarkerSelected:"markerSelected",onViewportChange:"viewportChange"};
jvm.MultiMap=function(a){var b=this;this.maps={};this.params=jvm.$.extend(!0,{},jvm.MultiMap.defaultParams,a);this.params.maxLevel=this.params.maxLevel||Number.MAX_VALUE;this.params.main=this.params.main||{};this.params.main.multiMapLevel=0;this.history=[this.addMap(this.params.main.map,this.params.main)];this.defaultProjection=this.history[0].mapData.projection.type;this.mapsLoaded={};this.params.container.css({position:"relative"});this.backButton=jvm.$("<div/>").addClass("jvectormap-goback").text("Back").appendTo(this.params.container);
this.backButton.hide();this.backButton.click(function(){b.goBack()});this.spinner=jvm.$("<div/>").addClass("jvectormap-spinner").appendTo(this.params.container);this.spinner.hide()};
jvm.MultiMap.prototype={addMap:function(a,b){var c=jvm.$("<div/>").css({width:"100%",height:"100%"});return this.params.container.append(c),this.maps[a]=new jvm.Map(jvm.$.extend(b,{container:c})),this.params.maxLevel>b.multiMapLevel&&this.maps[a].container.on("regionClick.jvectormap",{scope:this},function(a,b){var c=a.data.scope,d=c.params.mapNameByCode(b,c);c.drillDownPromise&&"pending"===c.drillDownPromise.state()||c.drillDown(d,b)}),this.maps[a]},downloadMap:function(a){var b=this,c=jvm.$.Deferred();
return this.mapsLoaded[a]?c.resolve():jvm.$.get(this.params.mapUrlByCode(a,this)).then(function(){b.mapsLoaded[a]=!0;c.resolve()},function(){c.reject()}),c},drillDown:function(a,b){var c=this.history[this.history.length-1],d=this,e=c.setFocus({region:b,animate:!0}),g=this.downloadMap(b);e.then(function(){"pending"===g.state()&&d.spinner.show()});g.always(function(){d.spinner.hide()});this.drillDownPromise=jvm.$.when(g,e);this.drillDownPromise.then(function(){c.params.container.hide();d.maps[a]?d.maps[a].params.container.show():
d.addMap(a,{map:a,multiMapLevel:c.params.multiMapLevel+1});d.history.push(d.maps[a]);d.backButton.show()})},goBack:function(){var a=this.history.pop(),b=this.history[this.history.length-1],c=this;a.setFocus({scale:1,x:.5,y:.5,animate:!0}).then(function(){a.params.container.hide();b.params.container.show();b.updateSize();1===c.history.length&&c.backButton.hide();b.setFocus({scale:1,x:.5,y:.5,animate:!0})})}};
jvm.MultiMap.defaultParams={mapNameByCode:function(a,b){return a.toLowerCase()+"_"+b.defaultProjection+"_en"},mapUrlByCode:function(a,b){return"jquery-jvectormap-data-"+a.toLowerCase()+"-"+b.defaultProjection+"-en.js"}};